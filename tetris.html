<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ðŸ§± Tetris Synthwave</title>
<link rel="stylesheet" href="style.css">

<!-- Fontes retrÃ´ -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">

<style>
  :root {
    --pink: #ff2dfb;
    --magenta: #d100d1;
    --cyan: #00eaff;
    --purple: #7a00ff;
    --yellow: #f7ff00;
    --bg: #0b0014;
  }

  * { box-sizing: border-box; }

  html, body {
    height: 100%;
    margin: 0;
    background: var(--bg);
    overflow: hidden;
    font-family: 'Press Start 2P', monospace;
    color: var(--cyan);
  }

  /* Fundo Synthwave */
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background:
      linear-gradient(to bottom, #3a004e 0%, #000010 40%) no-repeat,
      radial-gradient(circle at center top, #ff0088 0%, rgba(255,0,136,0) 60%) no-repeat;
    background-blend-mode: screen;
    animation: glow 4s ease-in-out infinite alternate;
    z-index: -3;
  }

  body::after {
    content: "";
    position: fixed;
    bottom: 0; left: 0;
    width: 100%;
    height: 60%;
    background-image:
      linear-gradient(to right, rgba(0,234,255,0.4) 1px, transparent 1px),
      linear-gradient(to top, rgba(255,45,251,0.25) 1px, transparent 1px);
    background-size: 40px 40px;
    transform: perspective(300px) rotateX(60deg);
    transform-origin: bottom;
    animation: gridMove 8s linear infinite;
    z-index: -2;
  }

  @keyframes gridMove {
    0% { background-position-y: 0px; }
    100% { background-position-y: 40px; }
  }

  @keyframes glow {
    from { opacity: 0.9; }
    to { opacity: 1; filter: brightness(1.2); }
  }

  header {
    text-align: center;
    padding: 20px 0 10px;
  }

  header h1 {
    font-size: 1.4rem;
    color: var(--pink);
    text-shadow: 0 0 8px var(--pink), 0 0 20px var(--magenta), 0 0 40px var(--cyan);
    letter-spacing: 4px;
    animation: flicker 2.5s infinite alternate;
  }

  header h2 {
    font-family: 'VT323';
    color: var(--cyan);
    font-size: 1.2rem;
    text-shadow: 0 0 10px var(--cyan), 0 0 20px var(--purple);
    margin-top: 6px;
  }

  @keyframes flicker {
    0%, 18%, 22%, 25%, 53%, 57%, 100% { opacity: 1; }
    20%, 24%, 55% { opacity: 0.6; }
  }

  .container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 40px;
  }

  canvas {
    border: 4px solid var(--magenta);
    border-radius: 10px;
    box-shadow: 0 0 20px var(--magenta), 0 0 40px var(--cyan);
    background: rgba(0,0,0,0.85);
  }

  .nextBox {
    text-align: center;
  }

  .nextBox canvas {
    background: rgba(0,0,0,0.8);
    border: 2px solid var(--cyan);
    box-shadow: 0 0 10px var(--cyan);
  }

  .hud {
    display: flex;
    justify-content: center;
    gap: 20px;
    font-size: 0.8rem;
    text-shadow: 0 0 10px var(--cyan);
    color: var(--cyan);
    margin-top: 10px;
  }

  .btn {
    background: transparent;
    border: 1px solid var(--pink);
    color: var(--pink);
    padding: 8px 10px;
    border-radius: 6px;
    font-family: 'VT323', monospace;
    font-size: 1rem;
    cursor: pointer;
    transition: 0.3s;
  }

  .btn:hover {
    background: var(--pink);
    color: #000;
    box-shadow: 0 0 15px var(--pink);
  }

  .crt {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    background: repeating-linear-gradient(rgba(255,255,255,0.03) 0px, rgba(0,0,0,0.05) 2px, rgba(0,0,0,0.05) 4px);
    z-index: 10;
  }

  footer {
    text-align: center;
    color: var(--pink);
    text-shadow: 0 0 10px var(--pink);
    font-family: 'VT323';
    margin-top: 10px;
  }
</style>
</head>

<body>
<header>
  <h1>NEON ARCADE</h1>
  <h2>Tetris Synthwave</h2>
</header>

<div class="container">
  <canvas id="tetris" width="200" height="400"></canvas>
  <div class="nextBox">
    <h3>PRÃ“XIMA</h3>
    <canvas id="next" width="100" height="100"></canvas>
  </div>
</div>

<div class="hud">
  <span>SCORE: <span id="score">0</span></span>
  <span>HI-SCORE: <span id="highScore">0</span></span>
  <button class="btn" id="restartBtn">RESTART</button>
  <button class="btn" onclick="location.href='index.html'">MENU</button>
</div>

<footer>ðŸŒ† Desenvolvido por Fliperama Â© 2025</footer>
<div class="crt"></div>

<script>
(() => {
  const canvas = document.getElementById('tetris');
  const ctx = canvas.getContext('2d');
  const nextCanvas = document.getElementById('next');
  const nctx = nextCanvas.getContext('2d');
  const scale = 20;
  ctx.scale(scale, scale);
  nctx.scale(20, 20);

  const scoreEl = document.getElementById('score');
  const highScoreEl = document.getElementById('highScore');
  const restartBtn = document.getElementById('restartBtn');

  let highScore = parseInt(localStorage.getItem('tetrisHigh')) || 0;
  let score = 0;
  highScoreEl.textContent = highScore;

  const colors = [
    null,
    '#ff2dfb', '#00eaff', '#f7ff00', '#7a00ff',
    '#ff0077', '#00ffa3', '#ff7f00',
  ];

  const arena = createMatrix(10, 20);
  const player = { pos: {x:0,y:0}, matrix:null, next:null };

  function createMatrix(w,h){
    const m=[];
    while(h--) m.push(new Array(w).fill(0));
    return m;
  }

  const pieces = 'ILJOTSZ';
  function createPiece(type){
    switch(type){
      case 'T': return [[0,0,0],[1,1,1],[0,1,0]];
      case 'O': return [[2,2],[2,2]];
      case 'L': return [[0,3,0],[0,3,0],[0,3,3]];
      case 'J': return [[0,4,0],[0,4,0],[4,4,0]];
      case 'I': return [[0,5,0,0],[0,5,0,0],[0,5,0,0],[0,5,0,0]];
      case 'S': return [[0,6,6],[6,6,0],[0,0,0]];
      case 'Z': return [[7,7,0],[0,7,7],[0,0,0]];
    }
  }

  function collide(arena,player){
    const [m,o]=[player.matrix,player.pos];
    for(let y=0;y<m.length;++y){
      for(let x=0;x<m[y].length;++x){
        if(m[y][x]!==0 &&
           (arena[y+o.y] && arena[y+o.y][x+o.x])!==0){
          return true;
        }
      }
    }
    return false;
  }

  function merge(arena,player){
    player.matrix.forEach((row,y)=>{
      row.forEach((value,x)=>{
        if(value!==0) arena[y+player.pos.y][x+player.pos.x]=value;
      });
    });
  }

  function rotate(matrix,dir){
    for(let y=0;y<matrix.length;++y){
      for(let x=0;x<y;++x){
        [matrix[x][y],matrix[y][x]]=[matrix[y][x],matrix[x][y]];
      }
    }
    if(dir>0) matrix.forEach(r=>r.reverse());
    else matrix.reverse();
  }

  function drawGrid(){
    ctx.strokeStyle = "rgba(0,234,255,0.2)";
    ctx.lineWidth = 0.05;
    for(let x=0;x<10;x++){
      ctx.beginPath();
      ctx.moveTo(x,0);
      ctx.lineTo(x,20);
      ctx.stroke();
    }
    for(let y=0;y<20;y++){
      ctx.beginPath();
      ctx.moveTo(0,y);
      ctx.lineTo(10,y);
      ctx.stroke();
    }
  }

  function arenaSweep(){
    outer: for(let y=arena.length-1;y>=0;--y){
      for(let x=0;x<arena[y].length;++x){
        if(arena[y][x]===0) continue outer;
      }
      const row=arena.splice(y,1)[0].fill(0);
      arena.unshift(row);
      ++y;
      score+=10;
      scoreEl.textContent=score;
      if(score>highScore){
        highScore=score;
        localStorage.setItem('tetrisHigh',highScore);
        highScoreEl.textContent=highScore;
      }
    }
  }

  function playerReset(){
    player.matrix = player.next || createPiece(pieces[(Math.random()*pieces.length)|0]);
    player.next = createPiece(pieces[(Math.random()*pieces.length)|0]);
    player.pos.y=0;
    player.pos.x=(arena[0].length/2|0)-(player.matrix[0].length/2|0);
    if(collide(arena,player)){
      arena.forEach(row=>row.fill(0));
      score=0;
      scoreEl.textContent=score;
    }
    drawNext();
  }

  function drawMatrix(matrix,offset,context=ctx){
    matrix.forEach((row,y)=>{
      row.forEach((value,x)=>{
        if(value!==0){
          context.fillStyle=colors[value];
          context.fillRect(x+offset.x,y+offset.y,1,1);
        }
      });
    });
  }

  function drawNext(){
    nctx.fillStyle='rgba(0,0,0,0.9)';
    nctx.fillRect(0,0,nextCanvas.width,nextCanvas.height);
    drawMatrix(player.next,{x:1,y:1},nctx);
  }

  function draw(){
    ctx.fillStyle='rgba(0,0,0,0.85)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    drawGrid();
    drawMatrix(arena,{x:0,y:0});
    drawMatrix(player.matrix,player.pos);
  }

  let dropCounter=0;
  let dropInterval=800;
  let lastTime=0;
  function update(time=0){
    const delta=time-lastTime;
    lastTime=time;
    dropCounter+=delta;
    if(dropCounter>dropInterval) playerDrop();
    draw();
    requestAnimationFrame(update);
  }

  function playerDrop(){
    player.pos.y++;
    if(collide(arena,player)){
      player.pos.y--;
      merge(arena,player);
      arenaSweep();
      playerReset();
    }
    dropCounter=0;
  }

  function playerMove(offset){
    player.pos.x+=offset;
    if(collide(arena,player)) player.pos.x-=offset;
  }

  document.addEventListener('keydown',e=>{
    if(e.key==='ArrowLeft') playerMove(-1);
    else if(e.key==='ArrowRight') playerMove(1);
    else if(e.key==='ArrowDown') playerDrop();
    else if(e.key==='ArrowUp'){ rotate(player.matrix,1); if(collide(arena,player)) rotate(player.matrix,-1); }
  });

  restartBtn.addEventListener('click',()=>{
    arena.forEach(r=>r.fill(0));
    score=0;
    scoreEl.textContent=0;
    playerReset();
  });

  playerReset();
  update();
})();
</script>
</body>
</html>

